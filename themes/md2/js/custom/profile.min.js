$(function(){var c=$("#doctor-form"),d=$("#btnSubmit"),e=c.attr("data-url-return");d.click(function(){var f=b.form();if(f){a()}});var b=c.validate({rules:{"doctor[name]":{required:true,maxlength:45},"doctor[state_id]":{required:true},"doctor[city_id]":{required:true},"doctor[hospital_name]":{required:true},"doctor[hp_dept_name]":{required:true},"doctor[clinical_title]":{required:true},"doctor[academic_title]":{required:true},"doctor[mobile]":{required:true,isMobile:true},"doctor[verify_code]":{required:true,digits:true,maxlength:6,minlength:6},"doctor[password]":{required:true,minlength:4},"doctor[password_repeat]":{required:true,equalTo:"#doctor_password"},"doctor[terms]":{required:true,min:1,max:1}},messages:{"doctor[name]":{required:"请填写称呼",maxlength:"请将字数控制在45以内"},"doctor[state_id]":{required:"请选择省份"},"doctor[city_id]":{required:"请选择城市"},"doctor[hospital_name]":{required:"请填写您所在的医院名称"},"doctor[hp_dept_name]":{required:"请填写您所在的科室名称"},"doctor[clinical_title]":{required:"请选择临床职称"},"doctor[academic_title]":{required:"请选择学术职称"},"doctor[mobile]":{required:"请填写手机号码",isMobile:"请输入正确的中国手机号码"},"doctor[verify_code]":{required:"请填写验证码",digits:"验证码只能为6位数字",maxlength:"验证码只能为6位数字",minlength:"验证码只能为6位数字"},"doctor[password]":{required:"请填写密码",minlength:"密码长度不得小于4"},"doctor[password_repeat]":{required:"请确认密码",equalTo:"密码不一致"},"doctor[terms]":{required:"请同意在线服务条款",min:"请同意在线服务条款",max:"请同意在线服务条款"}},errorElement:"div",errorPlacement:function(f,g){f.appendTo(g.parents("li"))}});function a(){requestUrl=c.attr("data-url-action");var g=c.serializeArray();var f=structure_formdata("doctor",g);var h=do_encrypt(f,pubkey);var i={param:h};disabledBtn(d);c.ajaxSubmit({type:"post",url:requestUrl,data:i,success:function(j){if(j.status=="ok"){J.popup({html:'<div><div class="popup-title">提示</div><div class="popup-content"><h4>提交成功！</h4><div class="mt20"><a data-target="link" href="'+e+'" class="btn btn-yes btn-block">确定</a></div></div></div>',pos:"center"})}else{c.find("div.error").remove();for(error in j.errors){errerMsg=j.errors[error];inputKey="#doctor_"+error;$(inputKey).focus();$(inputKey).parent().after("<div class='error'>"+errerMsg+"</div> ")}enableBtn(d)}},error:function(j,l,k){J.hideMask();J.showToast("网络异常，操作失败","","2000");console.log(j);console.log(l);console.log(k)},complete:function(){}})}});