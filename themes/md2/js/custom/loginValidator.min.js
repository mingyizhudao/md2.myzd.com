$(function(){var g=$("#smsLogin-form"),i=$("#btnSubmitSms"),h=g.attr("data-url-checkCode"),j=g.attr("data-url-action"),c=g.attr("data-url-return");$.validator.addMethod("isMobile",function(q,o){var p=q.length;var n=/^(13[0-9]{9})|(18[0-9]{9})|(14[0-9]{9})|(17[0-9]{9})|(15[0-9]{9})$/;return this.optional(o)||(p==11&&n.test(q))},"请填写正确的手机号码");i.click(function(){J.showMask("加载中...");var o=l.form();if(o){var p=$("#UserDoctorMobileLoginForm_captcha_code").val();var n=g.serializeArray();$.ajax({type:"post",url:h+"?co_code="+p,data:n,success:function(q){if(q.status=="ok"){e()}else{J.hideMask();$("#UserDoctorMobileLoginForm_captcha_code-error").remove();$("#captchaCode").after('<div id="UserDoctorMobileLoginForm_captcha_code-error" class="error">'+q.error+"</div>");$("#UserDoctorMobileLoginForm_captcha_code").focus()}}})}else{J.hideMask()}});var l=g.validate({rules:{"UserDoctorMobileLoginForm[username]":{required:true,isMobile:true},"UserDoctorMobileLoginForm[captcha_code]":{required:true},"UserDoctorMobileLoginForm[verify_code]":{required:true,digits:true,maxlength:6,minlength:6}},messages:{"UserDoctorMobileLoginForm[username]":{required:"请输入手机号码",isMobile:"请输入正确的中国手机号码!"},"UserDoctorMobileLoginForm[captcha_code]":{required:"请输入图形验证码"},"UserDoctorMobileLoginForm[verify_code]":{required:"请输入短信验证码",digits:"请输入正确的短信验证码",maxlength:"请输入正确的短信验证码",minlength:"请输入正确的短信验证码"}},errorElement:"div",errorPlacement:function(n,o){o.parents("div.input").find("div.error").remove();o.parents("div.input").find("div.errorMessage").remove();n.appendTo(o.parents("div.input"))}});function e(){var o=g.serializeArray();var n=structure_formdata("UserDoctorMobileLoginForm",o);var p=do_encrypt(n,pubkey);var q={param:p};$.ajax({type:"post",url:j,data:q,success:function(s){if(s.status=="ok"){location.href=c}else{g.find("div.error").remove();for(error in s.errors){var r=s.errors[error];var t="#UserDoctorMobileLoginForm_"+error;$(t).parents("div.inputBorder").after("<div class='error'>"+r+"</div>");J.hideMask()}}},error:function(r,t,s){console.log(r);console.log(t);console.log(s)},})}var k=$("#pawLogin-form"),b=$("#btnSubmitPaw"),m=g.attr("data-url-action"),d=g.attr("data-url-return");$.validator.addMethod("isMobile",function(q,o){var p=q.length;var n=/^(13[0-9]{9})|(18[0-9]{9})|(14[0-9]{9})|(17[0-9]{9})|(15[0-9]{9})$/;return this.optional(o)||(p==11&&n.test(q))},"请填写正确的手机号码");$.validator.addMethod("isPassword",function(p,o){var n=/^[a-zA-Z0-9_]+$/;return this.optional(o)||(n.test(p))},"请填写字母、数字或下划线");b.click(function(){J.showMask("加载中...");var n=a.form();if(n){f()}else{J.hideMask()}});var a=k.validate({rules:{"UserLoginForm[username]":{required:true,isMobile:true},"UserLoginForm[password]":{required:true,isPassword:true,minlength:4}},messages:{"UserLoginForm[username]":{required:"请输入手机号码",isMobile:"请输入正确的中国手机号码!"},"UserLoginForm[password]":{required:"请输入密码",minlength:"密码至少4位"}},errorElement:"div",errorPlacement:function(n,o){o.parents("div.input").find("div.error").remove();o.parents("div.input").find("div.errorMessage").remove();n.appendTo(o.parents("div.input"))}});function f(){var o=k.serializeArray();var n=structure_formdata("UserLoginForm",o);var p=do_encrypt(n,pubkey);var q={param:p};$.ajax({type:"post",url:m,data:q,success:function(s){if(s.status=="ok"){location.href=d}else{g.find("div.error").remove();for(error in s.errors){var r=s.errors[error];var t="#UserLoginForm_"+error;$(t).parents("div.inputBorder").after("<div class='error'>"+r+"</div>");J.hideMask()}}},error:function(r,t,s){console.log(r);console.log(t);console.log(s)},})}});