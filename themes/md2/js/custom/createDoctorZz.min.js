$(function(){var d=$("#docZz-form"),b=$("#btnSubmit"),c=d.attr("action"),g=d.attr("data-url-return");$.validator.addMethod("feeValidator",function(o,n){var m=o;var p=$("#DoctorZhuanzhenForm_fee_min").val();return this.optional(n)||(m>=p)},"最高额度需大于最低额度");$("input").change(function(){var m=$(this).attr("id");a.element("#"+m)});$(".checkNumber").tap(function(n){n.preventDefault();$("#otherFee").html("<input type='radio' name='DoctorZhuanzhenForm[fee]' id='fee4' checked='checked' value=''/>");var m="<div class='col-1 checkFee p11 selectFee0'>"+"<input type='radio' name='DoctorZhuanzhenForm[fee]' id='fee0' value='0'/>"+"<label for='fee0' class='ui-btn ui-corner-all'> 不需要</label>"+"</div>"+"<div class='col-1 checkFee p11 selectFee500'>"+"<input type='radio' name='DoctorZhuanzhenForm[fee]' id='fee500' value='500'/>"+"<label for='fee500' class='ui-btn ui-corner-all'> 500元</label>"+"</div>"+"<div class='col-1 checkFee p11 selectFee1000'>"+"<input type='radio' name='DoctorZhuanzhenForm[fee]' id='fee1000' value='1000'/>"+"<label for='fee1000' class='ui-btn ui-corner-all'> 1000元</label>"+"</div>";$(".numberFee").html(m);k();$(".checkNumber").removeAttr("readonly")});k();$(".checkPrepDay").tap(function(m){m.preventDefault();var n=$(this).find("input[name='DoctorZhuanzhenForm[prep_days]']").val();h(n)});function h(m){if(m=="3d"){$(".select-1w").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='1w' value='1w'/><label for='1w' class='ui-btn ui-corner-all checkPrepDay'> 一周内</label>");$(".select-2w").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='2w' value='2w'/><label for='2w' class='ui-btn ui-corner-all checkPrepDay'> 两周内</label>");$(".select-3w").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='3w' value='3w'/><label for='3w' class='ui-btn ui-corner-all checkPrepDay'> 三周内</label>")}else{if(m=="1w"){$(".select-3d").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='3d' value='3d'/><label for='3d' class='ui-btn ui-corner-all checkPrepDay'> 三天内</label>");$(".select-2w").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='2w' value='2w'/><label for='2w' class='ui-btn ui-corner-all checkPrepDay'> 两周内</label>");$(".select-3w").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='3w' value='3w'/><label for='3w' class='ui-btn ui-corner-all checkPrepDay'> 三周内</label>")}else{if(m=="2w"){$(".select-3d").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='3d' value='3d'/><label for='3d' class='ui-btn ui-corner-all checkPrepDay'> 三天内</label>");$(".select-1w").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='1w' value='1w'/><label for='1w' class='ui-btn ui-corner-all checkPrepDay'> 一周内</label>");$(".select-3w").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='3w' value='3w'/><label for='3w' class='ui-btn ui-corner-all checkPrepDay'> 三周内</label>")}else{if(m=="3w"){$(".select-3d").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='3d' value='3d'/><label for='3d' class='ui-btn ui-corner-all checkPrepDay'> 三天内</label>");$(".select-1w").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='1w' value='1w'/><label for='1w' class='ui-btn ui-corner-all checkPrepDay'> 一周内</label>");$(".select-2w").html("<input type='radio' name='DoctorZhuanzhenForm[prep_days]' id='2w' value='2w'/><label for='2w' class='ui-btn ui-corner-all checkPrepDay'> 两周内</label>")}}}}}b.click(function(m){m.preventDefault();if(a.form()){e()}});var a=d.validate({rules:{"DoctorZhuanzhenForm[fee]":{required:true},"DoctorZhuanzhenForm[preferred_patient]":{required:true},"DoctorZhuanzhenForm[prep_days]":{required:true}},messages:{"DoctorZhuanzhenForm[fee]":{required:"请选择转诊费"},"DoctorZhuanzhenForm[preferred_patient]":{required:"请填写对转诊病例的要求"},"DoctorZhuanzhenForm[prep_days]":{required:"请填写您最快多久能安排手术"}},errorElement:"div",errorPlacement:function(m,n){m.appendTo(n.parents("li"))},submitHandler:function(){}});function e(){var n=$("#docHz-form");var o=j(n);var m=l();if((m=="")||(isNaN(m))||(m<0)){$(".feeNum").after('<div id="fee-error" class="error">请输入金额</div>');J.closePopup();J.hideMask();b.removeAttr("disabled");return}$.ajax({type:"post",url:c,data:o,dataType:"json",processData:false,contentType:false,"success":function(p){if(p.status){location.href=g}},"error":function(p){console.log(p)},"complete":function(){}})}function j(p){var n="";var m="";var r="";n=$("textarea[name='DoctorZhuanzhenForm[preferred_patient]']").val();$("input[name='DoctorZhuanzhenForm[fee]']").each(function(){if($(this).attr("checked")){m=$(this).val()}});$("input[name='DoctorZhuanzhenForm[prep_days]']").each(function(){if($(this).attr("checked")){r=$(this).val()}});if(($(".checkNumber").val()!=null)&&($(".checkNumber").val()!="")){m=$(".checkNumber").val()}var s=$("#DoctorZhuanzhenForm_id").val();var o=$("#DoctorZhuanzhenForm_is_join").val();var q=new FormData();q.append("DoctorZhuanzhenForm[is_join]",o);q.append("DoctorZhuanzhenForm[preferred_patient]",n);
q.append("DoctorZhuanzhenForm[fee]",m);q.append("DoctorZhuanzhenForm[prep_days]",r);return q}function l(){var m="";$("input[name='DoctorZhuanzhenForm[fee]']").each(function(){if($(this).attr("checked")){m=$(this).val()}});if(($(".checkNumber").val()!=null)&&($(".checkNumber").val()!="")){m=$(".checkNumber").val()}return m}function i(){var m="";$("input[name='DoctorZhuanzhenForm[fee]']").each(function(){if($(this).attr("checked")){m=$(this).attr("id")}});return m}function k(){$(".checkFee").tap(function(m){m.preventDefault();var n=$(this).find("input[name='DoctorZhuanzhenForm[fee]']").attr("id");if(n!="fee4"){$("#otherFee").html("<input type='radio' name='DoctorZhuanzhenForm[fee]' id='fee4' value=''/>");f(n);$(".checkNumber").val("");$(".checkNumber").attr("readonly","true")}});$(".checkFee").tap(function(m){m.preventDefault();$("#fee-error").remove()});$(".checkNumber").on("change",function(){$("#fee-error").remove()})}function f(m){if(m=="fee0"){$(".selectFee500").html("<input type='radio' name='DoctorZhuanzhenForm[fee]' id='fee500' value='500'/><label for='fee500' class='ui-btn ui-corner-all'> 500元</label>");$(".selectFee1000").html("<input type='radio' name='DoctorZhuanzhenForm[fee]' id='fee1000' value='1000'/><label for='fee1000' class='ui-btn ui-corner-all'> 1000元</label>")}else{if(m=="fee500"){$(".selectFee0").html("<input type='radio' name='DoctorZhuanzhenForm[fee]' id='fee0' value='0'/><label for='fee0' class='ui-btn ui-corner-all'> 不需要</label>");$(".selectFee1000").html("<input type='radio' name='DoctorZhuanzhenForm[fee]' id='fee1000' value='1000'/><label for='fee1000' class='ui-btn ui-corner-all'> 1000元</label>")}else{if(m=="fee1000"){$(".selectFee0").html("<input type='radio' name='DoctorZhuanzhenForm[fee]' id='fee0' value='0'/><label for='fee0' class='ui-btn ui-corner-all'> 不需要</label>");$(".selectFee500").html("<input type='radio' name='DoctorZhuanzhenForm[fee]' id='fee500' value='500'/><label for='fee500' class='ui-btn ui-corner-all'> 500元</label>")}}}}});